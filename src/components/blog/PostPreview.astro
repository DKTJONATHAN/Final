---
// /src/components/blog/PostPreview.astro
import type { CollectionEntry } from "astro:content";
import { formatDate } from "@/utils/date";

interface Props {
  post: CollectionEntry<"posts">;
  featured?: boolean;
}

const { post, featured = false } = Astro.props;
const { title, description, publishDate, author, category, image } = post.data;
---

<article class={`post-preview ${featured ? 'featured' : ''}`}>
  <a href={`/posts/${post.slug}/`} class="group block">
    {image && (
      <div class="aspect-video mb-4 overflow-hidden rounded-lg bg-gray-100 dark:bg-gray-800">
        <img
          src={image.src}
          alt={image.alt}
          class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          loading="lazy"
        />
      </div>
    )}
    
    <div class="content">
      {category && (
        <span class="mb-2 inline-block rounded-full bg-red-100 px-3 py-1 text-xs font-medium text-red-800 dark:bg-red-900/30 dark:text-red-200">
          {category}
        </span>
      )}
      
      <h3 class="mb-2 text-lg font-semibold leading-tight group-hover:text-red-600 dark:group-hover:text-red-400 transition-colors">
        {title}
      </h3>
      
      {description && (
        <p class="mb-3 text-sm text-gray-600 dark:text-gray-400 line-clamp-2">
          {description}
        </p>
      )}
      
      <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-500">
        <span>By {author}</span>
        <time datetime={publishDate.toISOString()}>
          {formatDate(publishDate)}
        </time>
      </div>
    </div>
  </a>
</article>

<style>
  .post-preview.featured {
    @apply border-l-4 border-red-500 pl-4;
  }
  
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .content {
    @apply space-y-2;
  }
</style>