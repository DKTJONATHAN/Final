---
import { getCollection } from "astro:content";

// Simple password check (store this in environment variables later)
const validPassword = "admin123"; // Change this!
const inputPassword = Astro.url.searchParams.get('password');

if (inputPassword !== validPassword) {
  return Astro.redirect('/admin/login');
}

const posts = await getCollection("post");
---
<html>
<head>
  <title>Admin Panel</title>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: 2rem auto; }
    li { padding: 0.5rem; border-bottom: 1px solid #eee; }
  </style>
</head>
<body>
  <h1>üìù Admin Panel</h1>
  <a href="/admin/logout" style="color: red; float: right;">Logout</a>
  
  <ul>
    {posts.map(post => (
      <li>
        <strong>{post.data.title}</strong>
        <div style="color: #666; font-size: 0.9rem;">
          Slug: {post.slug} | Published: {post.data.publishDate.toISOString().split('T')[0]}
        </div>
      </li>
    ))}
  </ul>

  <div style="margin-top: 2rem;">
    <a href="/admin/new" style="background: #4CAF50; color: white; padding: 0.5rem 1rem; text-decoration: none;">
      ‚ûï New Post
    </a>
  </div>
</body>
</html>