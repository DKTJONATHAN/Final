---
import { getCollection } from 'astro:content';
import Note from '@/components/note/Note.astro';
import BaseLayout from '@/layouts/Base.astro';

export async function getStaticPaths() {
  const allNotes = await getCollection('note');
  const validNotes = allNotes.filter(note => 
    note.data.pubDate && !isNaN(new Date(note.data.pubDate).getTime())
  );
  
  return [{
    params: { page: 'index' },
    props: { 
      notes: validNotes,
      meta: {
        title: 'Notes',
        description: 'Collection of notes',
        articleDate: new Date().toISOString()
      }
    }
  }];
}

const { notes } = Astro.props;
---

<BaseLayout meta={Astro.props.meta}>
  <div class="grid gap-6 md:grid-cols-2">
    {notes.map(note => (
      <Note note={note} />
    ))}
  </div>
</BaseLayout>