---
// src/pages/index.astro
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('posts');
const sortedPosts = posts.sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
const featuredPost = sortedPosts[0];
const recentPosts = sortedPosts.slice(1, 7);
---

<Layout title="The Mwaniki's Report - Professional News & Insights">
  <div class="container">
    
    <!-- Hero Section with Featured Post -->
    {featuredPost && (
      <section class="hero-section">
        <span class="hero-badge">FEATURED STORY</span>
        <h1 class="hero-title">
          <a href={`/posts/${featuredPost.slug}`} style="color: inherit; text-decoration: none;">
            {featuredPost.data.title}
          </a>
        </h1>
        <p class="hero-description">
          {featuredPost.data.description}
        </p>
        <div class="hero-meta">
          <span>{new Date(featuredPost.data.date).toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          })}</span>
          <span>â€¢</span>
          <span>{featuredPost.data.author || 'Jonathan Mwaniki'}</span>
        </div>
      </section>
    )}

    <!-- Latest News Grid -->
    <section class="articles-section">
      <h2 class="section-title">Latest News</h2>

      <div class="articles-grid">
        {recentPosts.map((post) => (
          <article class="article-card">
            {post.data.image && (
              <img 
                src={post.data.image} 
                alt={post.data.title}
                class="article-image"
              />
            )}
            
            <div class="article-content">
              {post.data.category && (
                <span class="article-category">
                  {post.data.category}
                </span>
              )}
              
              <h3 class="article-title">
                <a href={`/posts/${post.slug}`} style="color: inherit; text-decoration: none;">
                  {post.data.title}
                </a>
              </h3>
              
              <p class="article-description">
                {post.data.description}
              </p>
              
              <div class="article-footer">
                <span>{new Date(post.data.date).toLocaleDateString('en-US', {
                  month: 'short',
                  day: 'numeric',
                  year: 'numeric'
                })}</span>
                <a 
                  href={`/posts/${post.slug}`}
                  class="read-more"
                >
                  <span>Read More</span>
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </a>
              </div>
            </div>
          </article>
        ))}
      </div>
    </section>

    <!-- Newsletter Signup -->
    <section class="newsletter-section">
      <h3 class="newsletter-title">Stay Informed</h3>
      <p class="newsletter-description">
        Get the latest news and insights delivered straight to your inbox. Join our community of informed readers.
      </p>
      <form class="newsletter-form">
        <input 
          type="email" 
          placeholder="Enter your email"
          class="newsletter-input"
          required
        />
        <button 
          type="submit"
          class="newsletter-btn"
        >
          Subscribe
        </button>
      </form>
    </section>
  </div>
</Layout>